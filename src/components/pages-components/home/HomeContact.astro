---
import useLang from "@utils/useLang";
import ButtonIcon from "@components/buttons/ButtonIcon.astro";
import sources from "@consts/sources";
import Github from "@assets/icons/github.svg";
import Linkedin from "@assets/icons/linkedin.svg";
import Email from "@assets/icons/email.svg";
import Button from "@components/buttons/Button.astro";
const { t } = useLang(Astro.url);
const mailtoSubject = t("contact.mailSubject");
const mailtoHref = `mailto:${sources.email}?subject=${encodeURIComponent(
  mailtoSubject
)}`;
---

<section id="contact" class="w-full h-vh p-0 sm:p-10">
  <div
    class="sm:max-w-7xl mx-auto px-6 sm:px-10 xl:px-0 py-10 grid grid-cols-1 gap-10"
  >
    <div class="flex flex-col gap-3">
      <h4 class="text-3xl font-bold text-center">
        {t("contact.sectionTitle")}
      </h4>
      <p class="text-center text-2 sm:w-4/4 md:w-3/4 lg:w-2/4 mx-auto">
        {t("contact.sectionDescription")}
      </p>
    </div>

    <div
      class="grid gap-7 grid-cols-1 sm:grid-cols-[1fr_1px_1fr] items-center justify-center"
    >
      <div class="w-full flex items-center justify-center">
        <div class="grid grid-cols-2 sm:grid-cols-1 gap-2 items-center">
          <h6 class="text-2xl font-bold">
            {t("contact.stayInTouchTitle")}
          </h6>
          <div class="grid grid-cols-1 gap-2">
            <p class="text-md font-semibold">{sources.name}</p>
            <a
              class="text-md font-semibold cursor-pointer no-underline hover:underline hover:text-gray-600 underline-offset-2"
              href={mailtoHref}
            >
              {sources.email}
            </a>
            <p class="text-md font-semibold">{sources.phone}</p>
            <div class="flex items-center gap-3">
              <ButtonIcon variant="white" href={sources.github}>
                <Github />
              </ButtonIcon>
              <ButtonIcon variant="white" href={sources.linkedin}>
                <Linkedin />
              </ButtonIcon>
              <ButtonIcon variant="white" href={mailtoHref}>
                <Email />
              </ButtonIcon>
            </div>
          </div>
        </div>
      </div>
      <div class="w-[1px] h-full bg-2"></div>
      <div class="w-full sm:w-3/4 flex flex-col gap-3 p-4 mx-auto">
        <h6 class="text-2xl font-bold mb-2 sm:text-left text-center">
          {t("contact.form.title")}
        </h6>
        <form
          id="contact-form"
          method="post"
          novalidate
          class="grid grid-cols-1 gap-5 static"
          data-error-name={t("contact.form.errors.name")}
          data-error-email={t("contact.form.errors.email")}
          data-error-message={t("contact.form.errors.message")}
          data-status-invalid={t("contact.form.status.invalid")}
          data-status-success={t("contact.form.status.success")}
          data-status-error={t("contact.form.status.error")}
        >
          <input
            type="text"
            name="company"
            tabindex="-1"
            autocomplete="off"
            aria-hidden="true"
            class="hidden"
          />
          <div class="grid gap-1">
            <input
              id="contact-name"
              class="w-full p-2 border-2 border-black rounded-lg"
              type="text"
              name="name"
              autocomplete="name"
              required
              aria-describedby="contact-name-error"
              placeholder={t("contact.form.namePlaceholder")}
            />
            <p
              id="contact-name-error"
              data-error-for="name"
              class="text-sm text-red-600"
            >
            </p>
          </div>
          <div class="grid gap-1">
            <input
              id="contact-email"
              class="w-full p-2 border-2 border-black rounded-lg"
              type="email"
              name="email"
              autocomplete="email"
              required
              aria-describedby="contact-email-error"
              placeholder={t("contact.form.emailPlaceholder")}
            />
            <p
              id="contact-email-error"
              data-error-for="email"
              class="text-sm text-red-600"
            >
            </p>
          </div>
          <div class="grid gap-1">
            <textarea
              id="contact-message"
              class="w-full p-2 border-2 border-black rounded-lg"
              name="message"
              rows="5"
              required
              aria-describedby="contact-message-error"
              placeholder={t("contact.form.messagePlaceholder")}></textarea>
            <p
              id="contact-message-error"
              data-error-for="message"
              class="text-sm text-red-600"
            >
            </p>
          </div>
            <dialog
              id="contact-status"
              data-status-modal
              role="alertdialog"
              aria-live="polite"
              class="contact-status-dialog"
            >
              <div
                class="text-sm px-4 py-3  bg-white rounded-lg shadow-md  "
              >
                <p data-status-message class="text-sm"></p>
                <div class="mt-3 flex justify-end">
                  <button
                    type="button"
                    data-status-close
                    class="text-sm font-semibold underline cursor-pointer"
                  >
                    {t("contact.form.close")}
                  </button>
                </div>
              </div>
            </dialog>

          <div class="flex items-center justify-center sm:justify-start">
            <Button type="submit" variant="black" size="sm" class=""
              >{t("contact.form.submit")}</Button
            >
          </div>
        </form>
      </div>
    </div>
  </div>
</section>

<style>
  :global(.contact-status-dialog) {
    position: fixed;
    inset: 0;
    margin: 0;
    padding: 0;
    border: 0;
    width: 100vw;
    height: 100dvh;
    max-width: none;
    max-height: none;
    display: none;
    background: transparent;
    z-index: 50;
    place-items: center;
  }

  :global(.contact-status-dialog[open]) {
    display: grid;
    place-items: center;
    background: transparent;
  }

  :global(.contact-status-dialog::backdrop) {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.55);
  }

  :global(body.dialog-open) {
    overflow: hidden;
  }
</style>

<script src="../../../scripts/contact-form.ts"></script>
